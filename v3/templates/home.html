{% extends 'bootstrap/base.html' %}

{%- block title %}
{{ title }}
{%- endblock title %}

{% block styles %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css">
    <style>
        form {
            display: block;
        }
    </style>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
        function replaceMap(src) {
            const map = document.querySelector('#map');
            map.src = src;
        }

        function buildWay() {
            replaceMap("{{ url_for('static', filename='loading.gif')}}")
            let start = document.querySelector('#start').value;
            let end = document.querySelector('#end').value;
            fetch(`{{url_for('build_way')}}?start=${start}&end=${end}`)
            .then(response => response.json())
            .then(data => {
                console.log(data.map)
                replaceMap(data.map)
            })
            .catch(error => console.error(error));
        }
    </script>
{% endblock %}

{% block content %}
    <div class="d-flex flex-column align-items-center justify-content-around">
        <img class='h-75 w-50 p-3' id='map' src="{{ map_src }}" alt="">
        
        <div class="d-flex flex-row justify-content-between m-4">
            <div class="d-flex flex-column align-items-center m-4">
                <label for="start">Початкова точка:</label>
                <select id='start' class="form-select" aria-label="Початкова точка">
                    {% for node in nodes %}
                        <option value={{ node.id }}>{{ node.title }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="flex-column align-items-center m-4">
                <label for="end">Кінцева точка:</label>
                <select id='end' class="form-select" aria-label="Початкова точка">
                    {% for node in nodes %}
                        <option value={{ node.id }}>{{ node.title }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
            

        <div class="d-flex justify-content-between">
            <a href="{{ url_for('home') }}" id="homeButton" class="btn btn-warning mx-2">Спочатку</a>
            <a id="addEdgeButton" class="btn btn-danger mx-2">Додати ребро</a>
            <button onclick="buildWay()" id="buildWayButton" class="btn btn-primary">Побудувати шлях</button>
            <a id="addNodeButton" class="btn btn-success mx-2">Додати вершину</a>
        </div>
        
        
    </div>
{% endblock %}